import{b as f}from"./index-46a986ed.js";import{y as l}from"./web3-db635edc.js";function p(r,a){return a.forEach(function(t){t&&typeof t!="string"&&!Array.isArray(t)&&Object.keys(t).forEach(function(e){if(e!=="default"&&!(e in r)){var i=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,i.get?i:{enumerable:!0,get:function(){return t[e]}})}})}),Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}var g={},c={},d={};Object.defineProperty(d,"__esModule",{value:!0});d.getLowerCase=void 0;function m(r){return r&&r.toLowerCase()}d.getLowerCase=m;Object.defineProperty(c,"__esModule",{value:!0});c.SafeAppProvider=void 0;const _=l.exports,h=d;class v extends _.EventEmitter{constructor(a,t){super(),this.submittedTxs=new Map,this.safe=a,this.sdk=t}async connect(){this.emit("connect",{chainId:this.chainId})}async disconnect(){}get chainId(){return this.safe.chainId}async request(a){const{method:t,params:e=[]}=a;switch(t){case"eth_accounts":return[this.safe.safeAddress];case"net_version":case"eth_chainId":return`0x${this.chainId.toString(16)}`;case"personal_sign":{const[s,n]=e;if(this.safe.safeAddress.toLowerCase()!==n.toLowerCase())throw new Error("The address or message hash is invalid");return await this.sdk.txs.signMessage(s),"0x"}case"eth_sign":{const[s,n]=e;if(this.safe.safeAddress.toLowerCase()!==s.toLowerCase()||!n.startsWith("0x"))throw new Error("The address or message hash is invalid");return await this.sdk.txs.signMessage(n),"0x"}case"eth_sendTransaction":const i=Object.assign({value:"0",data:"0x"},e[0]),u=await this.sdk.txs.send({txs:[i]});return this.submittedTxs.set(u.safeTxHash,{from:this.safe.safeAddress,hash:u.safeTxHash,gas:0,gasPrice:"0x00",nonce:0,input:i.data,value:i.value,to:i.to,blockHash:null,blockNumber:null,transactionIndex:null}),u.safeTxHash;case"eth_blockNumber":return(await this.sdk.eth.getBlockByNumber(["latest"])).number;case"eth_getBalance":return this.sdk.eth.getBalance([(0,h.getLowerCase)(e[0]),e[1]]);case"eth_getCode":return this.sdk.eth.getCode([(0,h.getLowerCase)(e[0]),e[1]]);case"eth_getTransactionCount":return this.sdk.eth.getTransactionCount([(0,h.getLowerCase)(e[0]),e[1]]);case"eth_getStorageAt":return this.sdk.eth.getStorageAt([(0,h.getLowerCase)(e[0]),e[1],e[2]]);case"eth_getBlockByNumber":return this.sdk.eth.getBlockByNumber([e[0],e[1]]);case"eth_getBlockByHash":return this.sdk.eth.getBlockByHash([e[0],e[1]]);case"eth_getTransactionByHash":let o=e[0];try{o=(await this.sdk.txs.getBySafeTxHash(o)).txHash||o}catch{}return this.submittedTxs.has(o)?this.submittedTxs.get(o):this.sdk.eth.getTransactionByHash([o]).then(s=>(s&&(s.hash=e[0]),s));case"eth_getTransactionReceipt":{let s=e[0];try{s=(await this.sdk.txs.getBySafeTxHash(s)).txHash||s}catch{}return this.sdk.eth.getTransactionReceipt([s]).then(n=>(n&&(n.transactionHash=e[0]),n))}case"eth_estimateGas":return this.sdk.eth.getEstimateGas(e[0]);case"eth_call":return this.sdk.eth.call([e[0],e[1]]);case"eth_getLogs":return this.sdk.eth.getPastLogs([e[0]]);case"eth_gasPrice":return this.sdk.eth.getGasPrice();default:throw Error(`"${a.method}" not implemented`)}}send(a,t){a||t("Undefined request"),this.request(a).then(e=>t(null,{jsonrpc:"2.0",id:a.id,result:e})).catch(e=>t(e,null))}}c.SafeAppProvider=v;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.SafeAppProvider=void 0;var a=c;Object.defineProperty(r,"SafeAppProvider",{enumerable:!0,get:function(){return a.SafeAppProvider}})})(g);var b=f(g),k=p({__proto__:null,default:b},[g]);export{k as i};
